2025-07-09 11:10:18,307 - INFO - === Final WebSocket Notification Test ===
2025-07-09 11:10:18,328 - INFO - This test uses a fresh manager token to test the complete system
2025-07-09 11:10:18,337 - INFO - 1. Connect to SignalR hub via WebSocket
2025-07-09 11:10:18,346 - INFO - 2. Send notifications via REST API (with manager permissions)
2025-07-09 11:10:18,358 - INFO - 3. Verify messages are received via WebSocket
2025-07-09 11:10:18,390 - INFO - Connecting to SignalR hub...
2025-07-09 11:10:21,397 - ERROR - WebSocket not connected, cannot send notifications
2025-07-09 11:10:23,225 - INFO - WebSocket connection established successfully
2025-07-09 11:10:23,239 - INFO - Sending handshake: {"protocol": "json", "version": 1}
2025-07-09 11:10:23,257 - INFO - Handshake sent successfully
2025-07-09 11:10:23,306 - INFO - Starting to listen for messages...
2025-07-09 11:10:38,238 - INFO - === MESSAGE #1 ===
2025-07-09 11:10:38,251 - INFO - Raw message: {"error":"Handshake was canceled."}
2025-07-09 11:10:38,263 - INFO - Message is not valid JSON
2025-07-09 11:10:38,320 - INFO - === END MESSAGE #1 ===

2025-07-09 11:10:38,716 - ERROR - WebSocket connection closed
2025-07-09 11:10:38,786 - INFO - === Test Complete ===
2025-07-09 11:10:38,870 - INFO - Check final_websocket_test.log for detailed logs
