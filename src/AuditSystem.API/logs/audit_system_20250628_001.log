2025-06-28 19:46:52.921 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 19:46:53.148 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 19:46:53.223 +05:30 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5049: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-06-28 19:49:06.712 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 19:49:06.888 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 19:49:06.917 +05:30 [INF] Now listening on: http://localhost:5049
2025-06-28 19:49:06.920 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-28 19:49:06.922 +05:30 [INF] Hosting environment: Development
2025-06-28 19:49:06.924 +05:30 [INF] Content root path: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API
2025-06-28 19:49:12.085 +05:30 [INF] Application is shutting down...
2025-06-28 19:49:21.002 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 19:49:21.210 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 19:49:21.254 +05:30 [INF] Now listening on: http://localhost:5049
2025-06-28 19:49:21.263 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-28 19:49:21.265 +05:30 [INF] Hosting environment: Development
2025-06-28 19:49:21.268 +05:30 [INF] Content root path: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API
2025-06-28 19:51:14.742 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 229
2025-06-28 19:51:14.844 +05:30 [WRN] Failed to determine the https port for redirect.
2025-06-28 19:51:14.919 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:51:14.955 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 19:51:16.883 +05:30 [INF] Executed DbCommand (64ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:51:16.949 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 19:51:16.972 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 19:51:17.157 +05:30 [ERR] Failed executing DbCommand (11ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 19:51:17.183 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-06-28 19:51:17.210 +05:30 [ERR] Error during registration for user: testuser_1751120474
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.Repository`1.SaveChangesAsync() in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\Repository.cs:line 63
   at AuditSystem.Services.UserService.CreateUserAsync(User user, String password) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 63
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 57
2025-06-28 19:51:17.249 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 19:51:17.265 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 2302.3387ms
2025-06-28 19:51:17.272 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:51:17.278 +05:30 [ERR] HTTP POST /api/v1/Auth/register responded 500 in 2421.0443 ms
2025-06-28 19:51:17.290 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 500 null application/json; charset=utf-8 2551.8922ms
2025-06-28 19:52:34.938 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 225
2025-06-28 19:52:34.949 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:52:34.953 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 19:52:34.991 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:52:34.999 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 19:52:35.007 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 19:52:35.021 +05:30 [ERR] Failed executing DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 19:52:35.038 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-06-28 19:52:35.085 +05:30 [ERR] Error during registration for user: testuser_1751120554
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.Repository`1.SaveChangesAsync() in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\Repository.cs:line 63
   at AuditSystem.Services.UserService.CreateUserAsync(User user, String password) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 63
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 57
2025-06-28 19:52:35.128 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 19:52:35.133 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 175.5727ms
2025-06-28 19:52:35.135 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:52:35.136 +05:30 [ERR] HTTP POST /api/v1/Auth/register responded 500 in 191.1853 ms
2025-06-28 19:52:35.139 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 500 null application/json; charset=utf-8 200.7991ms
2025-06-28 19:55:00.416 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 225
2025-06-28 19:55:00.425 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:55:00.427 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 19:55:00.591 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:55:00.597 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 19:55:00.607 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 19:55:00.618 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 19:55:00.722 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 19:55:00.730 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 300.4997ms
2025-06-28 19:55:00.734 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:55:00.738 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 314.9246 ms
2025-06-28 19:55:00.741 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 324.9504ms
2025-06-28 19:57:08.801 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 225
2025-06-28 19:57:08.808 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:57:08.811 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 19:57:08.942 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:57:08.950 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 19:57:08.957 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 19:57:08.969 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 19:57:08.978 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 19:57:08.982 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 166.7854ms
2025-06-28 19:57:08.986 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 19:57:08.990 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 181.3502 ms
2025-06-28 19:57:08.994 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 193.4441ms
2025-06-28 19:57:09.001 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 63
2025-06-28 19:57:09.008 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 19:57:09.016 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 19:57:09.031 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:57:09.047 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:57:09.052 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 19:57:09.055 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 35.4391ms
2025-06-28 19:57:09.058 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 19:57:09.059 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 200 in 50.8795 ms
2025-06-28 19:57:09.062 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 200 null application/json; charset=utf-8 61.1226ms
2025-06-28 19:57:09.070 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12 - application/json null
2025-06-28 19:57:09.145 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 19:57:09.152 +05:30 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.User]] GetUser(System.Guid) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 19:57:09.188 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 19:57:09.194 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.Domain.Entities.User'.
2025-06-28 19:57:09.231 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API) in 74.2086ms
2025-06-28 19:57:09.234 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 19:57:09.236 +05:30 [INF] HTTP GET /api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12 responded 200 in 153.1746 ms
2025-06-28 19:57:09.240 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12 - 200 null application/json; charset=utf-8 170.0823ms
2025-06-28 19:57:09.247 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5049/api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12 - application/json 194
2025-06-28 19:57:09.260 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 19:57:09.268 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 19:57:09.272 +05:30 [INF] HTTP PUT /api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12 responded 403 in 18.0618 ms
2025-06-28 19:57:09.278 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5049/api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12 - 403 0 null 30.6057ms
2025-06-28 19:57:09.283 +05:30 [INF] Request starting HTTP/1.1 PATCH http://localhost:5049/api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12/change-password - application/json 69
2025-06-28 19:57:09.294 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.ChangePassword (AuditSystem.API)'
2025-06-28 19:57:09.300 +05:30 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] ChangePassword(System.Guid, AuditSystem.API.Controllers.ChangePasswordRequest) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 19:57:09.313 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 19:57:09.342 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@p11='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = Boolean), @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, first_name = @p2, is_active = @p3, last_name = @p4, organisation_id = @p5, password_hash = @p6, password_salt = @p7, phone = @p8, role = @p9, username = @p10
WHERE user_id = @p11;
2025-06-28 19:57:09.352 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-06-28 19:57:09.354 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.ChangePassword (AuditSystem.API) in 48.6507ms
2025-06-28 19:57:09.357 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.ChangePassword (AuditSystem.API)'
2025-06-28 19:57:09.358 +05:30 [INF] HTTP PATCH /api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12/change-password responded 204 in 66.7387 ms
2025-06-28 19:57:09.362 +05:30 [INF] Request finished HTTP/1.1 PATCH http://localhost:5049/api/v1/Users/0148a028-577c-4f4b-b8d5-117d6ff3df12/change-password - 204 null null 78.8495ms
2025-06-28 19:57:09.367 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 66
2025-06-28 19:57:09.376 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 19:57:09.378 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 19:57:09.383 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:57:09.389 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 19:57:09.395 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 19:57:09.397 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 16.4366ms
2025-06-28 19:57:09.400 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 19:57:09.402 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 200 in 25.5834 ms
2025-06-28 19:57:09.406 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 200 null application/json; charset=utf-8 38.8256ms
2025-06-28 20:00:03.403 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 225
2025-06-28 20:00:03.600 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:00:03.602 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:00:03.613 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:00:03.619 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 20:00:03.627 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 20:00:03.639 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 20:00:03.670 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 20:00:03.677 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 70.388ms
2025-06-28 20:00:03.680 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:00:03.681 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 81.2887 ms
2025-06-28 20:00:03.684 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 280.6455ms
2025-06-28 20:00:03.689 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 63
2025-06-28 20:00:03.696 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:00:03.698 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:00:03.702 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:00:03.708 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:00:03.713 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 20:00:03.715 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 14.8456ms
2025-06-28 20:00:03.717 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:00:03.718 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 200 in 22.7659 ms
2025-06-28 20:00:03.721 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 200 null application/json; charset=utf-8 31.6944ms
2025-06-28 20:00:03.731 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844 - application/json null
2025-06-28 20:00:03.736 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 20:00:03.738 +05:30 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.User]] GetUser(System.Guid) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 20:00:03.746 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 20:00:03.751 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.Domain.Entities.User'.
2025-06-28 20:00:03.753 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API) in 9.6419ms
2025-06-28 20:00:03.757 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 20:00:03.761 +05:30 [INF] HTTP GET /api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844 responded 200 in 25.3366 ms
2025-06-28 20:00:03.765 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844 - 200 null application/json; charset=utf-8 33.6102ms
2025-06-28 20:00:03.772 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5049/api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844 - application/json 194
2025-06-28 20:00:03.781 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:00:03.783 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:00:03.785 +05:30 [INF] HTTP PUT /api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844 responded 403 in 4.6596 ms
2025-06-28 20:00:03.790 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5049/api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844 - 403 0 null 18.2562ms
2025-06-28 20:00:03.817 +05:30 [INF] Request starting HTTP/1.1 PATCH http://localhost:5049/api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844/change-password - application/json 69
2025-06-28 20:00:03.823 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.ChangePassword (AuditSystem.API)'
2025-06-28 20:00:03.826 +05:30 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] ChangePassword(System.Guid, AuditSystem.API.Controllers.ChangePasswordRequest) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 20:00:03.832 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 20:00:03.838 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p11='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = Boolean), @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, first_name = @p2, is_active = @p3, last_name = @p4, organisation_id = @p5, password_hash = @p6, password_salt = @p7, phone = @p8, role = @p9, username = @p10
WHERE user_id = @p11;
2025-06-28 20:00:03.844 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-06-28 20:00:03.846 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.ChangePassword (AuditSystem.API) in 16.2003ms
2025-06-28 20:00:03.848 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.ChangePassword (AuditSystem.API)'
2025-06-28 20:00:03.850 +05:30 [INF] HTTP PATCH /api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844/change-password responded 204 in 27.7194 ms
2025-06-28 20:00:03.853 +05:30 [INF] Request finished HTTP/1.1 PATCH http://localhost:5049/api/v1/Users/ad9166a2-e822-4a39-b3c7-239c1dddd844/change-password - 204 null null 35.6517ms
2025-06-28 20:00:03.883 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 66
2025-06-28 20:00:03.887 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:00:03.890 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:00:03.928 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:00:03.933 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:00:03.936 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 20:00:03.938 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 42.8809ms
2025-06-28 20:00:03.941 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:00:03.944 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 200 in 57.0515 ms
2025-06-28 20:00:03.947 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 200 null application/json; charset=utf-8 63.6121ms
2025-06-28 20:01:07.604 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/swagger/v1/swagger.json - null null
2025-06-28 20:01:07.823 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 219.1084ms
2025-06-28 20:02:41.597 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 72
2025-06-28 20:02:41.643 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:02:41.647 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:02:41.650 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:02:41.721 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:02:41.728 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:02:41.732 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 20:02:41.734 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 81.1269ms
2025-06-28 20:02:41.735 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:02:41.737 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 200 in 95.9723 ms
2025-06-28 20:02:41.739 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 200 null application/json; charset=utf-8 142.7121ms
2025-06-28 20:03:16.217 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:03:16.223 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:03:16.225 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:03:16.228 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 5.6973 ms
2025-06-28 20:03:16.232 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 14.8052ms
2025-06-28 20:03:55.873 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:03:55.878 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:03:55.903 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:03:55.909 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 31.6353 ms
2025-06-28 20:03:55.917 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 44.0277ms
2025-06-28 20:03:58.366 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:03:58.372 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:03:58.375 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:03:58.377 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 5.4710 ms
2025-06-28 20:03:58.382 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 16.0467ms
2025-06-28 20:03:59.017 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:03:59.023 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:03:59.025 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:03:59.028 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 5.3095 ms
2025-06-28 20:03:59.032 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 14.3993ms
2025-06-28 20:03:59.566 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:03:59.572 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:03:59.574 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:03:59.576 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 4.6929 ms
2025-06-28 20:03:59.596 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 29.4777ms
2025-06-28 20:04:00.084 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:04:00.089 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:04:00.091 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:04:00.093 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 4.9681 ms
2025-06-28 20:04:00.097 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 13.0565ms
2025-06-28 20:04:00.590 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:04:00.594 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:04:00.596 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:04:00.599 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 4.9090 ms
2025-06-28 20:04:00.614 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 23.6493ms
2025-06-28 20:04:01.111 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:04:01.116 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:04:01.118 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:04:01.121 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 5.0141 ms
2025-06-28 20:04:01.125 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 14.0086ms
2025-06-28 20:04:01.676 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users - null null
2025-06-28 20:04:01.681 +05:30 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (admin|manager)
2025-06-28 20:04:01.683 +05:30 [INF] AuthenticationScheme: Bearer was forbidden.
2025-06-28 20:04:01.685 +05:30 [INF] HTTP GET /api/v1/Users responded 403 in 4.1667 ms
2025-06-28 20:04:01.688 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users - 403 0 null 12.6998ms
2025-06-28 20:30:39.582 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/login - null null
2025-06-28 20:30:39.596 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:30:39.603 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/login responded 204 in 9.3975 ms
2025-06-28 20:30:39.607 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/login - 204 null null 25.6732ms
2025-06-28 20:30:39.613 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 63
2025-06-28 20:30:39.617 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:30:39.619 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:30:39.621 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:30:39.723 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:30:39.733 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:30:39.738 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 20:30:39.742 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 116.4465ms
2025-06-28 20:30:39.745 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 20:30:39.747 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 200 in 130.1335 ms
2025-06-28 20:30:39.751 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 200 null application/json; charset=utf-8 137.6345ms
2025-06-28 20:32:08.237 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 20:32:08.243 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:32:08.247 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 3.3172 ms
2025-06-28 20:32:08.251 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 14.0575ms
2025-06-28 20:32:08.261 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 185
2025-06-28 20:32:08.267 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:32:08.270 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:32:08.273 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:32:08.289 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:32:08.310 +05:30 [ERR] An exception occurred while iterating over the results of a query for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-28 20:32:08.326 +05:30 [ERR] Error during registration for user: johndoe
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.UserRepository.GetByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\UserRepository.cs:line 18
   at AuditSystem.Services.UserService.GetUserByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 92
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 40
2025-06-28 20:32:08.342 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 20:32:08.344 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 60.9062ms
2025-06-28 20:32:08.347 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:32:08.348 +05:30 [ERR] HTTP POST /api/v1/Auth/register responded 500 in 80.9223 ms
2025-06-28 20:32:08.350 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 500 null application/json; charset=utf-8 88.4365ms
2025-06-28 20:32:15.278 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 20:32:15.283 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:32:15.285 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 2.1537 ms
2025-06-28 20:32:15.290 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 12.1578ms
2025-06-28 20:32:15.301 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 185
2025-06-28 20:32:15.310 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:32:15.312 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:32:15.315 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:32:15.325 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:32:15.332 +05:30 [ERR] An exception occurred while iterating over the results of a query for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-28 20:32:15.350 +05:30 [ERR] Error during registration for user: johndoe
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.UserRepository.GetByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\UserRepository.cs:line 18
   at AuditSystem.Services.UserService.GetUserByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 92
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 40
2025-06-28 20:32:15.368 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 20:32:15.371 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 50.4576ms
2025-06-28 20:32:15.374 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:32:15.376 +05:30 [ERR] HTTP POST /api/v1/Auth/register responded 500 in 66.4643 ms
2025-06-28 20:32:15.381 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 500 null application/json; charset=utf-8 79.6761ms
2025-06-28 20:39:44.110 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 20:39:44.125 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:39:44.128 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 3.5757 ms
2025-06-28 20:39:44.132 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 22.4211ms
2025-06-28 20:39:44.144 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 185
2025-06-28 20:39:44.150 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:39:44.155 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:39:44.158 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:39:44.336 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:39:44.342 +05:30 [ERR] An exception occurred while iterating over the results of a query for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-28 20:39:44.366 +05:30 [ERR] Error during registration for user: johndoe
System.InvalidCastException: Column 'organisation_id' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetGuid(Int32 ordinal)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadGuid(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.UserRepository.GetByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\UserRepository.cs:line 18
   at AuditSystem.Services.UserService.GetUserByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 92
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 40
2025-06-28 20:39:44.387 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 20:39:44.391 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 226.2815ms
2025-06-28 20:39:44.394 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:39:44.397 +05:30 [ERR] HTTP POST /api/v1/Auth/register responded 500 in 246.7560 ms
2025-06-28 20:39:44.402 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 500 null application/json; charset=utf-8 257.9702ms
2025-06-28 20:39:50.701 +05:30 [INF] Application is shutting down...
2025-06-28 20:40:27.886 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 20:40:28.165 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 20:40:28.228 +05:30 [INF] Now listening on: http://localhost:5049
2025-06-28 20:40:28.233 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-28 20:40:28.235 +05:30 [INF] Hosting environment: Development
2025-06-28 20:40:28.239 +05:30 [INF] Content root path: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API
2025-06-28 20:40:41.130 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 20:40:41.308 +05:30 [WRN] Failed to determine the https port for redirect.
2025-06-28 20:40:41.326 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:40:41.340 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 9.9819 ms
2025-06-28 20:40:41.394 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 269.5978ms
2025-06-28 20:40:41.438 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 185
2025-06-28 20:40:41.460 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:40:41.562 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:40:41.624 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:40:44.755 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:40:44.998 +05:30 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 20:40:45.028 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 3391.7798ms
2025-06-28 20:40:45.034 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:40:45.044 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 400 in 3584.8917 ms
2025-06-28 20:40:45.084 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 400 null application/json; charset=utf-8 3650.489ms
2025-06-28 20:40:51.776 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 20:40:51.786 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:40:51.794 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 9.7996 ms
2025-06-28 20:40:51.805 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 29.1835ms
2025-06-28 20:40:51.818 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 186
2025-06-28 20:40:51.828 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:40:51.851 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:40:51.858 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:40:51.945 +05:30 [INF] Executed DbCommand (13ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:40:52.000 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 20:40:52.043 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 20:40:52.348 +05:30 [ERR] Failed executing DbCommand (33ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 20:40:52.416 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-06-28 20:40:52.474 +05:30 [ERR] Error during registration for user: johndoe1
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.Repository`1.SaveChangesAsync() in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\Repository.cs:line 63
   at AuditSystem.Services.UserService.CreateUserAsync(User user, String password) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 63
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 67
2025-06-28 20:40:52.536 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 20:40:52.543 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 679.9086ms
2025-06-28 20:40:52.548 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:40:52.551 +05:30 [ERR] HTTP POST /api/v1/Auth/register responded 500 in 722.6669 ms
2025-06-28 20:40:52.559 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 500 null application/json; charset=utf-8 740.9052ms
2025-06-28 20:51:35.814 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 20:51:36.312 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 20:51:36.372 +05:30 [INF] Now listening on: http://localhost:5049
2025-06-28 20:51:36.378 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-28 20:51:36.380 +05:30 [INF] Hosting environment: Development
2025-06-28 20:51:36.382 +05:30 [INF] Content root path: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API
2025-06-28 20:51:54.999 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 20:51:55.198 +05:30 [WRN] Failed to determine the https port for redirect.
2025-06-28 20:51:55.228 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:51:55.247 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 28.4241 ms
2025-06-28 20:51:55.318 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 322.152ms
2025-06-28 20:51:55.373 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 186
2025-06-28 20:51:55.395 +05:30 [INF] CORS policy execution successful.
2025-06-28 20:51:55.495 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:51:55.558 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 20:51:59.658 +05:30 [INF] Executed DbCommand (126ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 20:51:59.899 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 20:51:59.984 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 20:52:00.458 +05:30 [ERR] Failed executing DbCommand (37ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 20:52:00.561 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-06-28 20:52:00.653 +05:30 [ERR] Error during registration for user: johndoe1
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "users" violates foreign key constraint "users_organisation_id_fkey"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: users_organisation_id_fkey
    File: ri_triggers.c
    Line: 2607
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.Repository`1.SaveChangesAsync() in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\Repository.cs:line 63
   at AuditSystem.Services.UserService.CreateUserAsync(User user, String password) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 63
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 87
2025-06-28 20:52:00.794 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 20:52:00.830 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 5261.2316ms
2025-06-28 20:52:00.835 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 20:52:00.843 +05:30 [ERR] HTTP POST /api/v1/Auth/register responded 500 in 5449.1092 ms
2025-06-28 20:52:00.886 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 500 null application/json; charset=utf-8 5515.5327ms
2025-06-28 21:16:46.648 +05:30 [INF] Application is shutting down...
2025-06-28 22:56:00.762 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 22:56:01.303 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 22:56:01.496 +05:30 [INF] Now listening on: http://localhost:5049
2025-06-28 22:56:01.508 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-28 22:56:01.521 +05:30 [INF] Hosting environment: Development
2025-06-28 22:56:01.527 +05:30 [INF] Content root path: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API
2025-06-28 22:56:32.302 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 22:56:32.444 +05:30 [WRN] Failed to determine the https port for redirect.
2025-06-28 22:56:32.454 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:56:32.468 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 10.9102 ms
2025-06-28 22:56:32.536 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 236.5402ms
2025-06-28 22:56:32.585 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 130
2025-06-28 22:56:32.619 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:56:32.746 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 22:56:32.811 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 22:56:36.709 +05:30 [INF] Executed DbCommand (124ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 22:56:36.879 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT o.organisation_id, o.created_at, o.name, o.region, o.type
FROM organisation AS o
WHERE lower(o.name) = @__ToLower_0
LIMIT 1
2025-06-28 22:56:37.276 +05:30 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO organisation (organisation_id, created_at, name, region, type)
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-28 22:56:37.319 +05:30 [INF] Created default organisation: john's Organisation with ID: "40e29463-4721-4614-a939-da60a3631aaf"
2025-06-28 22:56:37.377 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 22:56:37.419 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 22:56:37.433 +05:30 [ERR] Validation error during registration for user: johndoe1
System.InvalidOperationException: Email 'johndoe@example.com' is already registered
   at AuditSystem.Services.UserService.CreateUserAsync(User user, String password) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 49
   at AuditSystem.API.Controllers.AuthController.Register(RegisterRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 87
2025-06-28 22:56:37.535 +05:30 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 22:56:37.581 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 4748.553ms
2025-06-28 22:56:37.588 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 22:56:37.601 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 400 in 4984.4473 ms
2025-06-28 22:56:37.682 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 400 null application/json; charset=utf-8 5098.6662ms
2025-06-28 22:57:16.672 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - null null
2025-06-28 22:57:16.687 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:57:16.702 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/register responded 204 in 15.4434 ms
2025-06-28 22:57:16.733 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/register - 204 null null 60.9122ms
2025-06-28 22:57:16.769 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 123
2025-06-28 22:57:16.801 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:57:16.815 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 22:57:16.832 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 22:57:16.923 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 22:57:16.940 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT o.organisation_id, o.created_at, o.name, o.region, o.type
FROM organisation AS o
WHERE lower(o.name) = @__ToLower_0
LIMIT 1
2025-06-28 22:57:17.019 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO organisation (organisation_id, created_at, name, region, type)
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-28 22:57:17.036 +05:30 [INF] Created default organisation: John's Organisation 20250628172716 with ID: "d79b1103-9f78-4160-9078-a88588c97e25"
2025-06-28 22:57:17.047 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 22:57:17.072 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 22:57:17.668 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 22:57:17.779 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 22:57:17.799 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 955.6848ms
2025-06-28 22:57:17.807 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 22:57:17.815 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 1013.8653 ms
2025-06-28 22:57:17.833 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 1063.4561ms
2025-06-28 22:57:18.040 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - null null
2025-06-28 22:57:18.051 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:57:18.055 +05:30 [INF] HTTP OPTIONS /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 204 in 4.3147 ms
2025-06-28 22:57:18.062 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 204 null null 21.94ms
2025-06-28 22:57:18.252 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - application/json null
2025-06-28 22:57:18.281 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:57:18.449 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 22:57:18.467 +05:30 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.User]] GetUser(System.Guid) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 22:57:18.765 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 22:57:18.775 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.Domain.Entities.User'.
2025-06-28 22:57:18.914 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API) in 441.3725ms
2025-06-28 22:57:18.919 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 22:57:18.923 +05:30 [INF] HTTP GET /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 200 in 641.2469 ms
2025-06-28 22:57:18.936 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 200 null application/json; charset=utf-8 683.8694ms
2025-06-28 22:57:29.256 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - null null
2025-06-28 22:57:29.272 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:57:29.276 +05:30 [INF] HTTP OPTIONS /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 204 in 3.6170 ms
2025-06-28 22:57:29.288 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 204 null null 31.4901ms
2025-06-28 22:57:29.308 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - application/json null
2025-06-28 22:57:29.323 +05:30 [INF] CORS policy execution successful.
2025-06-28 22:57:29.337 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 22:57:29.344 +05:30 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.User]] GetUser(System.Guid) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 22:57:29.389 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 22:57:29.401 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.Domain.Entities.User'.
2025-06-28 22:57:29.407 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API) in 42.574ms
2025-06-28 22:57:29.416 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 22:57:29.421 +05:30 [INF] HTTP GET /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 200 in 98.6649 ms
2025-06-28 22:57:29.439 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 200 null application/json; charset=utf-8 131.8708ms
2025-06-28 23:01:38.652 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - null null
2025-06-28 23:01:38.688 +05:30 [INF] CORS policy execution successful.
2025-06-28 23:01:38.719 +05:30 [INF] HTTP OPTIONS /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 204 in 31.1080 ms
2025-06-28 23:01:38.750 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 204 null null 93.2428ms
2025-06-28 23:01:38.762 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - application/json null
2025-06-28 23:01:38.787 +05:30 [INF] CORS policy execution successful.
2025-06-28 23:01:38.802 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 23:01:38.810 +05:30 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.User]] GetUser(System.Guid) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 23:01:39.027 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 23:01:39.035 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.Domain.Entities.User'.
2025-06-28 23:01:39.040 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API) in 193.9646ms
2025-06-28 23:01:39.044 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 23:01:39.052 +05:30 [INF] HTTP GET /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 200 in 265.0011 ms
2025-06-28 23:01:39.060 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 200 null application/json; charset=utf-8 298.6784ms
2025-06-28 23:01:43.172 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - application/json null
2025-06-28 23:01:43.196 +05:30 [INF] CORS policy execution successful.
2025-06-28 23:01:43.228 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 23:01:43.258 +05:30 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.User]] GetUser(System.Guid) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 23:01:43.287 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 23:01:43.303 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.Domain.Entities.User'.
2025-06-28 23:01:43.323 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API) in 47.1413ms
2025-06-28 23:01:43.329 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 23:01:43.362 +05:30 [INF] HTTP GET /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 200 in 166.4536 ms
2025-06-28 23:01:43.458 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 200 null application/json; charset=utf-8 286.1077ms
2025-06-28 23:02:05.104 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/login - null null
2025-06-28 23:02:05.544 +05:30 [INF] CORS policy execution successful.
2025-06-28 23:02:05.668 +05:30 [INF] HTTP OPTIONS /api/v1/Auth/login responded 204 in 124.3855 ms
2025-06-28 23:02:05.744 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Auth/login - 204 null null 640.0467ms
2025-06-28 23:02:05.789 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 42
2025-06-28 23:02:05.825 +05:30 [INF] CORS policy execution successful.
2025-06-28 23:02:05.829 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:02:05.861 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:02:05.974 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:02:06.013 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:02:06.061 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 23:02:06.076 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 133.2807ms
2025-06-28 23:02:06.087 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:02:06.091 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 200 in 266.3233 ms
2025-06-28 23:02:06.096 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 200 null application/json; charset=utf-8 306.6825ms
2025-06-28 23:02:06.293 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - null null
2025-06-28 23:02:06.323 +05:30 [INF] CORS policy execution successful.
2025-06-28 23:02:06.356 +05:30 [INF] HTTP OPTIONS /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 204 in 33.6986 ms
2025-06-28 23:02:06.380 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 204 null null 87.1719ms
2025-06-28 23:02:06.423 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - application/json null
2025-06-28 23:02:06.460 +05:30 [INF] CORS policy execution successful.
2025-06-28 23:02:06.463 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 23:02:06.475 +05:30 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.User]] GetUser(System.Guid) on controller AuditSystem.API.Controllers.UsersController (AuditSystem.API).
2025-06-28 23:02:06.497 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE u.user_id = @__get_Item_0
LIMIT 1
2025-06-28 23:02:06.512 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.Domain.Entities.User'.
2025-06-28 23:02:06.524 +05:30 [INF] Executed action AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API) in 33.6833ms
2025-06-28 23:02:06.527 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.UsersController.GetUser (AuditSystem.API)'
2025-06-28 23:02:06.541 +05:30 [INF] HTTP GET /api/v1/Users/44b77613-4193-4138-81d9-841144458a79 responded 200 in 80.5586 ms
2025-06-28 23:02:06.554 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Users/44b77613-4193-4138-81d9-841144458a79 - 200 null application/json; charset=utf-8 131.183ms
2025-06-28 23:02:53.495 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/swagger/v1/swagger.json - null null
2025-06-28 23:02:54.033 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 537.8593ms
2025-06-28 23:04:09.304 +05:30 [INF] Application is shutting down...
2025-06-28 23:11:07.337 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 23:11:07.718 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 23:11:07.810 +05:30 [INF] Now listening on: http://localhost:5049
2025-06-28 23:11:07.819 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-28 23:11:07.823 +05:30 [INF] Hosting environment: Development
2025-06-28 23:11:07.832 +05:30 [INF] Content root path: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API
2025-06-28 23:15:02.297 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/Auth/register - application/json 249
2025-06-28 23:15:02.426 +05:30 [WRN] Failed to determine the https port for redirect.
2025-06-28 23:15:02.507 +05:30 [INF] HTTP POST /api/Auth/register responded 404 in 73.4674 ms
2025-06-28 23:15:02.549 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/Auth/register - 404 0 null 256.9586ms
2025-06-28 23:15:02.593 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:5049/api/Auth/register, Response status code: 404
2025-06-28 23:16:07.088 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 249
2025-06-28 23:16:07.111 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:16:07.177 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:16:10.659 +05:30 [INF] Executed DbCommand (301ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:16:10.940 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 23:16:11.456 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 23:16:12.093 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 23:16:12.218 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 23:16:12.252 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 5050.1357ms
2025-06-28 23:16:12.260 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:16:12.264 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 5161.1494 ms
2025-06-28 23:16:12.288 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Templates - application/json 765
2025-06-28 23:16:12.300 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 5213.0342ms
2025-06-28 23:16:12.457 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API)'
2025-06-28 23:16:12.485 +05:30 [INF] Route matched with {action = "CreateTemplate", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.Template]] CreateTemplate(AuditSystem.Domain.Entities.Template) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:16:12.602 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-06-28 23:16:12.657 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API) in 162.7629ms
2025-06-28 23:16:12.662 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API)'
2025-06-28 23:16:12.664 +05:30 [INF] HTTP POST /api/v1/Templates responded 400 in 366.0903 ms
2025-06-28 23:16:12.671 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Templates - 400 null application/problem+json; charset=utf-8 382.7976ms
2025-06-28 23:16:12.681 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates - application/json null
2025-06-28 23:16:12.704 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:16:12.714 +05:30 [INF] Route matched with {action = "GetTemplates", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplates() on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:16:12.834 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
2025-06-28 23:16:12.855 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:16:12.887 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API) in 167.7956ms
2025-06-28 23:16:12.899 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:16:12.906 +05:30 [INF] HTTP GET /api/v1/Templates responded 200 in 206.6296 ms
2025-06-28 23:16:12.916 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates - 200 null application/json; charset=utf-8 233.4421ms
2025-06-28 23:16:12.936 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Product Launch - application/json null
2025-06-28 23:16:12.967 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:16:12.984 +05:30 [INF] Route matched with {action = "GetTemplatesByCategory", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplatesByCategory(System.String) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:16:13.288 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__category_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
WHERE t.category = @__category_0 AND t.is_published
ORDER BY t.name
2025-06-28 23:16:13.296 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:16:13.301 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API) in 309.6423ms
2025-06-28 23:16:13.309 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:16:13.312 +05:30 [INF] HTTP GET /api/v1/Templates/category/Product Launch responded 200 in 351.3055 ms
2025-06-28 23:16:13.318 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Product Launch - 200 null application/json; charset=utf-8 382.2463ms
2025-06-28 23:18:24.935 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 249
2025-06-28 23:18:24.948 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:18:24.951 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:18:24.972 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:18:24.981 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 23:18:24.990 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 23:18:25.002 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 23:18:25.011 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 23:18:25.014 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 58.0156ms
2025-06-28 23:18:25.017 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:18:25.024 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 76.1023 ms
2025-06-28 23:18:25.028 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 93.7236ms
2025-06-28 23:18:25.049 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Templates - application/json 899
2025-06-28 23:18:25.063 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API)'
2025-06-28 23:18:25.066 +05:30 [INF] Route matched with {action = "CreateTemplate", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.Template]] CreateTemplate(AuditSystem.Domain.Entities.Template) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:18:25.081 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-06-28 23:18:25.086 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API) in 15.5693ms
2025-06-28 23:18:25.091 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API)'
2025-06-28 23:18:25.093 +05:30 [INF] HTTP POST /api/v1/Templates responded 400 in 30.5780 ms
2025-06-28 23:18:25.097 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Templates - 400 null application/problem+json; charset=utf-8 47.9642ms
2025-06-28 23:18:25.120 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates - application/json null
2025-06-28 23:18:25.133 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:18:25.148 +05:30 [INF] Route matched with {action = "GetTemplates", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplates() on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:18:25.155 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
2025-06-28 23:18:25.161 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:18:25.164 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API) in 11.6378ms
2025-06-28 23:18:25.168 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:18:25.174 +05:30 [INF] HTTP GET /api/v1/Templates responded 200 in 43.3730 ms
2025-06-28 23:18:25.180 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates - 200 null application/json; charset=utf-8 60.0659ms
2025-06-28 23:18:25.194 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Product Launch - application/json null
2025-06-28 23:18:25.206 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:18:25.209 +05:30 [INF] Route matched with {action = "GetTemplatesByCategory", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplatesByCategory(System.String) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:18:25.221 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__category_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
WHERE t.category = @__category_0 AND t.is_published
ORDER BY t.name
2025-06-28 23:18:25.238 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:18:25.242 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API) in 27.8388ms
2025-06-28 23:18:25.246 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:18:25.255 +05:30 [INF] HTTP GET /api/v1/Templates/category/Product Launch responded 200 in 49.0523 ms
2025-06-28 23:18:25.260 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Product Launch - 200 null application/json; charset=utf-8 66.2083ms
2025-06-28 23:20:20.452 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 249
2025-06-28 23:20:20.464 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:20:20.468 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:20:20.498 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:20:20.510 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 23:20:20.517 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 23:20:20.529 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 23:20:20.534 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 23:20:20.542 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 61.0126ms
2025-06-28 23:20:20.546 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:20:20.550 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 85.8442 ms
2025-06-28 23:20:20.558 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 104.9469ms
2025-06-28 23:20:20.570 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Templates - application/json 919
2025-06-28 23:20:20.588 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API)'
2025-06-28 23:20:20.593 +05:30 [INF] Route matched with {action = "CreateTemplate", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.Domain.Entities.Template]] CreateTemplate(AuditSystem.Domain.Entities.Template) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:20:20.602 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-06-28 23:20:20.609 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API) in 11.4641ms
2025-06-28 23:20:20.613 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.CreateTemplate (AuditSystem.API)'
2025-06-28 23:20:20.615 +05:30 [INF] HTTP POST /api/v1/Templates responded 400 in 29.1319 ms
2025-06-28 23:20:20.619 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Templates - 400 null application/problem+json; charset=utf-8 49.7159ms
2025-06-28 23:20:20.631 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates - application/json null
2025-06-28 23:20:20.639 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:20:20.647 +05:30 [INF] Route matched with {action = "GetTemplates", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplates() on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:20:20.663 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
2025-06-28 23:20:20.681 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:20:20.694 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API) in 41.7459ms
2025-06-28 23:20:20.698 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:20:20.701 +05:30 [INF] HTTP GET /api/v1/Templates responded 200 in 62.7503 ms
2025-06-28 23:20:20.709 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates - 200 null application/json; charset=utf-8 77.0898ms
2025-06-28 23:20:20.720 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Product Launch - application/json null
2025-06-28 23:20:20.729 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:20:20.733 +05:30 [INF] Route matched with {action = "GetTemplatesByCategory", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplatesByCategory(System.String) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:20:20.745 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__category_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
WHERE t.category = @__category_0 AND t.is_published
ORDER BY t.name
2025-06-28 23:20:20.751 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:20:20.762 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API) in 23.7561ms
2025-06-28 23:20:20.768 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:20:20.777 +05:30 [INF] HTTP GET /api/v1/Templates/category/Product Launch responded 200 in 48.8427 ms
2025-06-28 23:20:20.784 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Product Launch - 200 null application/json; charset=utf-8 63.4379ms
2025-06-28 23:22:28.561 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 249
2025-06-28 23:22:28.569 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:22:28.572 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:22:28.735 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:22:28.747 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 23:22:28.755 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 23:22:28.781 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 23:22:28.788 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 23:22:28.792 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 213.0825ms
2025-06-28 23:22:28.799 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:22:28.802 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 232.5557 ms
2025-06-28 23:22:28.806 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 200 null application/json; charset=utf-8 245.2444ms
2025-06-28 23:22:28.819 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates - application/json null
2025-06-28 23:22:28.830 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:22:28.834 +05:30 [INF] Route matched with {action = "GetTemplates", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplates() on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:22:28.846 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
2025-06-28 23:22:28.855 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:22:28.863 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API) in 24.5798ms
2025-06-28 23:22:28.868 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplates (AuditSystem.API)'
2025-06-28 23:22:28.871 +05:30 [INF] HTTP GET /api/v1/Templates responded 200 in 42.7096 ms
2025-06-28 23:22:28.879 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates - 200 null application/json; charset=utf-8 59.2017ms
2025-06-28 23:22:28.888 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates/published - application/json null
2025-06-28 23:22:28.903 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetPublishedTemplates (AuditSystem.API)'
2025-06-28 23:22:28.920 +05:30 [INF] Route matched with {action = "GetPublishedTemplates", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetPublishedTemplates() on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:22:28.962 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
WHERE t.is_published
ORDER BY t.name
2025-06-28 23:22:28.970 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:22:28.981 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetPublishedTemplates (AuditSystem.API) in 54.3423ms
2025-06-28 23:22:28.986 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetPublishedTemplates (AuditSystem.API)'
2025-06-28 23:22:28.988 +05:30 [INF] HTTP GET /api/v1/Templates/published responded 200 in 86.3713 ms
2025-06-28 23:22:28.997 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates/published - 200 null application/json; charset=utf-8 108.2973ms
2025-06-28 23:22:29.007 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates/user/2ec9284c-11c0-4b11-a772-21fc4bb95cb8 - application/json null
2025-06-28 23:22:29.024 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByUser (AuditSystem.API)'
2025-06-28 23:22:29.039 +05:30 [INF] Route matched with {action = "GetTemplatesByUser", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplatesByUser(System.Guid) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:22:29.150 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
WHERE t.created_by = @__userId_0
ORDER BY t.created_at DESC
2025-06-28 23:22:29.163 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:22:29.168 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplatesByUser (AuditSystem.API) in 120.0926ms
2025-06-28 23:22:29.172 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByUser (AuditSystem.API)'
2025-06-28 23:22:29.179 +05:30 [INF] HTTP GET /api/v1/Templates/user/2ec9284c-11c0-4b11-a772-21fc4bb95cb8 responded 200 in 156.8800 ms
2025-06-28 23:22:29.186 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates/user/2ec9284c-11c0-4b11-a772-21fc4bb95cb8 - 200 null application/json; charset=utf-8 179.7364ms
2025-06-28 23:22:29.198 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Store Visit - application/json null
2025-06-28 23:22:29.213 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:22:29.217 +05:30 [INF] Route matched with {action = "GetTemplatesByCategory", controller = "Templates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[AuditSystem.Domain.Entities.Template]]] GetTemplatesByCategory(System.String) on controller AuditSystem.API.Controllers.TemplatesController (AuditSystem.API).
2025-06-28 23:22:29.228 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__category_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.template_id, t.category, t.created_at, t.created_by, t.description, t.is_published, t.name, t.questions, t.scoring_rules, t.valid_from, t.valid_to, t.version
FROM template AS t
WHERE t.category = @__category_0 AND t.is_published
ORDER BY t.name
2025-06-28 23:22:29.236 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[AuditSystem.Domain.Entities.Template, AuditSystem.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-28 23:22:29.242 +05:30 [INF] Executed action AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API) in 19.1027ms
2025-06-28 23:22:29.249 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.TemplatesController.GetTemplatesByCategory (AuditSystem.API)'
2025-06-28 23:22:29.253 +05:30 [INF] HTTP GET /api/v1/Templates/category/Store Visit responded 200 in 40.3267 ms
2025-06-28 23:22:29.259 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates/category/Store Visit - 200 null application/json; charset=utf-8 60.856ms
2025-06-28 23:37:16.541 +05:30 [INF] User profile is available. Using 'C:\Users\sunny\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-28 23:37:17.419 +05:30 [WRN] The WebRootPath was not found: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\wwwroot. Static files may be unavailable.
2025-06-28 23:37:17.642 +05:30 [INF] Now listening on: http://localhost:5049
2025-06-28 23:37:17.758 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-28 23:37:17.814 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - application/json 240
2025-06-28 23:37:17.868 +05:30 [INF] Hosting environment: Development
2025-06-28 23:37:17.970 +05:30 [INF] Content root path: D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API
2025-06-28 23:37:18.138 +05:30 [WRN] Failed to determine the https port for redirect.
2025-06-28 23:37:18.355 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:37:18.500 +05:30 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Register(AuditSystem.API.Controllers.RegisterRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:37:31.250 +05:30 [INF] Executed DbCommand (526ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:37:31.804 +05:30 [INF] Executed DbCommand (62ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.username) = @__ToLower_0)
2025-06-28 23:37:31.969 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE lower(u.email) = @__ToLower_0)
2025-06-28 23:37:33.606 +05:30 [INF] Executed DbCommand (39ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Guid), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (user_id, created_at, email, first_name, last_name, organisation_id, password_hash, password_salt, phone, role, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING is_active;
2025-06-28 23:37:34.080 +05:30 [INF] Executing OkObjectResult, writing value of type 'AuditSystem.API.Controllers.AuthResponse'.
2025-06-28 23:37:34.237 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API) in 15701.921ms
2025-06-28 23:37:34.321 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Register (AuditSystem.API)'
2025-06-28 23:37:34.370 +05:30 [INF] HTTP POST /api/v1/Auth/register responded 200 in 16169.7101 ms
2025-06-28 23:37:34.636 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/register - 499 null application/json; charset=utf-8 16828.831ms
2025-06-28 23:45:40.899 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 77
2025-06-28 23:45:40.979 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:45:41.046 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:45:41.117 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-06-28 23:45:41.264 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 191.7363ms
2025-06-28 23:45:41.268 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:45:41.280 +05:30 [INF] HTTP POST /api/v1/Auth/login responded 400 in 320.9717 ms
2025-06-28 23:45:41.300 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 400 null application/problem+json; charset=utf-8 401.0462ms
2025-06-28 23:45:41.394 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Templates - application/json 612
2025-06-28 23:45:41.636 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenSignatureKeyNotFoundException: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignature(JsonWebToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignatureAndIssuerSecurityKey(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-06-28 23:45:41.732 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
2025-06-28 23:45:41.773 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-06-28 23:45:41.831 +05:30 [INF] AuthenticationScheme: Bearer was challenged.
2025-06-28 23:45:41.847 +05:30 [INF] HTTP POST /api/v1/Templates responded 401 in 412.9626 ms
2025-06-28 23:45:41.882 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Templates - 401 0 null 487.8035ms
2025-06-28 23:46:20.781 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5049/api/v1/Templates - application/json null
2025-06-28 23:46:20.874 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenSignatureKeyNotFoundException: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignature(JsonWebToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignatureAndIssuerSecurityKey(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-06-28 23:46:20.929 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
2025-06-28 23:46:20.940 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-06-28 23:46:20.951 +05:30 [INF] AuthenticationScheme: Bearer was challenged.
2025-06-28 23:46:20.969 +05:30 [INF] HTTP GET /api/v1/Templates responded 401 in 99.7692 ms
2025-06-28 23:46:20.985 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5049/api/v1/Templates - 401 0 null 203.9532ms
2025-06-28 23:46:21.411 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 70
2025-06-28 23:46:21.452 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:46:21.459 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:46:22.733 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:46:24.263 +05:30 [ERR] An exception occurred while iterating over the results of a query for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
System.InvalidCastException: Column 'password_salt' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at lambda_method26(Closure, DbDataReader, Int32[])
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadObject(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Column 'password_salt' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at lambda_method26(Closure, DbDataReader, Int32[])
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadObject(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-28 23:46:24.577 +05:30 [ERR] Error during login for user: template_tester_1751134580
System.InvalidCastException: Column 'password_salt' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at lambda_method26(Closure, DbDataReader, Int32[])
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadObject(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.UserRepository.GetByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\UserRepository.cs:line 20
   at AuditSystem.Services.UserService.AuthenticateAsync(String username, String password) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 26
   at AuditSystem.API.Controllers.AuthController.Login(LoginRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 126
2025-06-28 23:46:24.823 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 23:46:24.901 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 3433.5364ms
2025-06-28 23:46:24.935 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:46:24.951 +05:30 [ERR] HTTP POST /api/v1/Auth/login responded 500 in 3500.4814 ms
2025-06-28 23:46:24.996 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 500 null application/json; charset=utf-8 3584.3344ms
2025-06-28 23:46:25.171 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Templates - application/json 612
2025-06-28 23:46:25.412 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenSignatureKeyNotFoundException: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignature(JsonWebToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignatureAndIssuerSecurityKey(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-06-28 23:46:25.629 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
2025-06-28 23:46:25.666 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-06-28 23:46:25.680 +05:30 [INF] AuthenticationScheme: Bearer was challenged.
2025-06-28 23:46:25.713 +05:30 [INF] HTTP POST /api/v1/Templates responded 401 in 305.0322 ms
2025-06-28 23:46:25.753 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Templates - 401 0 null 581.65ms
2025-06-28 23:48:54.736 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - application/json 70
2025-06-28 23:48:55.034 +05:30 [INF] Executing endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:48:55.065 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[AuditSystem.API.Controllers.AuthResponse]] Login(AuditSystem.API.Controllers.LoginRequest) on controller AuditSystem.API.Controllers.AuthController (AuditSystem.API).
2025-06-28 23:48:55.715 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.user_id, u.created_at, u.email, u.first_name, u.is_active, u.last_name, u.organisation_id, u.password_hash, u.password_salt, u.phone, u.role, u.username
FROM users AS u
WHERE lower(u.username) = @__ToLower_0
LIMIT 1
2025-06-28 23:48:55.738 +05:30 [ERR] An exception occurred while iterating over the results of a query for context type 'AuditSystem.Infrastructure.Data.AuditSystemDbContext'.
System.InvalidCastException: Column 'password_salt' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at lambda_method26(Closure, DbDataReader, Int32[])
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadObject(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Column 'password_salt' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at lambda_method26(Closure, DbDataReader, Int32[])
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadObject(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-28 23:48:55.852 +05:30 [ERR] Error during login for user: template_tester_1751134733
System.InvalidCastException: Column 'password_salt' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.DbNullValueOrThrow[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at lambda_method26(Closure, DbDataReader, Int32[])
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadObject(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at AuditSystem.Infrastructure.Repositories.UserRepository.GetByUsernameAsync(String username) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Infrastructure\Repositories\UserRepository.cs:line 20
   at AuditSystem.Services.UserService.AuthenticateAsync(String username, String password) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.Services\UserService.cs:line 26
   at AuditSystem.API.Controllers.AuthController.Login(LoginRequest request) in D:\MyWorks\Retail-Execution-Audit-System\AuditSystem\src\AuditSystem.API\Controllers\AuthController.cs:line 126
2025-06-28 23:48:55.945 +05:30 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-06-28 23:48:55.962 +05:30 [INF] Executed action AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API) in 889.3958ms
2025-06-28 23:48:55.975 +05:30 [INF] Executed endpoint 'AuditSystem.API.Controllers.AuthController.Login (AuditSystem.API)'
2025-06-28 23:48:55.989 +05:30 [ERR] HTTP POST /api/v1/Auth/login responded 500 in 954.4911 ms
2025-06-28 23:48:56.023 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Auth/login - 500 null application/json; charset=utf-8 1287.1873ms
2025-06-28 23:48:56.184 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5049/api/v1/Templates - application/json 612
2025-06-28 23:48:56.221 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenSignatureKeyNotFoundException: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignature(JsonWebToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignatureAndIssuerSecurityKey(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-06-28 23:48:56.252 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10517: Signature validation failed. The token's kid is missing. Keys tried: 'Microsoft.IdentityModel.Tokens.SymmetricSecurityKey, KeyId: '', InternalId: 'KPLPXFy8riIEezAuOCPAobwIfHsdmG1AP5aVBJAJn7U'. , KeyId: 
'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
2025-06-28 23:48:56.263 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-06-28 23:48:56.269 +05:30 [INF] AuthenticationScheme: Bearer was challenged.
2025-06-28 23:48:56.280 +05:30 [INF] HTTP POST /api/v1/Templates responded 401 in 59.7844 ms
2025-06-28 23:48:56.297 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5049/api/v1/Templates - 401 0 null 112.8563ms
